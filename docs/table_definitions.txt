| table_schema | table_name                           | create_statement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------ | ------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public       | api_usage_log                        | CREATE TABLE public.api_usage_log (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, api_type text NOT NULL, api_endpoint text, request_query text, response_status text, response_time_ms integer, estimated_cost numeric(10,6), business_id uuid, backfill_progress_id uuid, user_id uuid, session_token text, google_place_id text, error_message text);                                                                                                                                                                                                                                                                                                                                                                                                        |
| public       | areas                                | CREATE TABLE public.areas (id uuid NOT NULL, code varchar(50) NOT NULL, name varchar(100) NOT NULL, polygon jsonb NOT NULL, center_lat numeric(10,7) NOT NULL, center_lng numeric(10,7) NOT NULL, area_km2 numeric(8,3), type varchar(20), aliases ARRAY, characteristics jsonb, business_count integer, created_at timestamp with time zone, updated_at timestamp with time zone, list_item_id uuid NOT NULL);                                                                                                                                                                                                                                                                                                                                                                  |
| public       | backfill_progress                    | CREATE TABLE public.backfill_progress (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, updated_at timestamp with time zone NOT NULL, city_id uuid, area_id uuid, category_id uuid, subcategory_id uuid, search_query text, search_location text, search_radius integer, status text NOT NULL, api_calls_used integer NOT NULL, businesses_found integer NOT NULL, businesses_added integer NOT NULL, businesses_skipped integer NOT NULL, bounds_ne_lat numeric(10,8), bounds_ne_lng numeric(11,8), bounds_sw_lat numeric(10,8), bounds_sw_lng numeric(11,8), last_error text, retry_count integer NOT NULL, max_retries integer NOT NULL, estimated_api_cost numeric(10,6), actual_api_cost numeric(10,6), notes text, metadata jsonb, priority_score integer); |
| public       | bookmarks                            | CREATE TABLE public.bookmarks (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, user_id uuid NOT NULL, business_id uuid NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public       | business_merge_log                   | CREATE TABLE public.business_merge_log (id uuid NOT NULL, kept_business_id uuid, removed_business_id uuid, merge_data jsonb, merged_by uuid, merged_at timestamp without time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public       | businesses                           | CREATE TABLE public.businesses (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, name text, address text, created_by uuid NOT NULL, website text, category_id uuid, subcategory_id uuid, is_deleted boolean NOT NULL, google_place_id text, city_id uuid, area_id uuid, latitude double precision, longitude double precision, backfill_source text, backfill_date timestamp with time zone, google_types ARRAY, verification_status text, last_verified timestamp with time zone, metadata jsonb, mapping_confidence text, mapping_reason text, mapping_metadata jsonb, needs_review boolean, auto_mapped_at timestamp with time zone, reviewed_at timestamp with time zone, reviewed_by uuid, neighbourhood_id uuid, neighbourhood_confidence varchar(20));     |
| public       | businesses_backup_before_area_update | CREATE TABLE public.businesses_backup_before_area_update (id uuid, neighbourhood_id uuid, area_id uuid, neighbourhood_confidence varchar(20), mapping_reason text, auto_mapped_at timestamp with time zone, created_at timestamp with time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public       | businesses_backup_before_polygon_fix | CREATE TABLE public.businesses_backup_before_polygon_fix (id uuid, neighbourhood_id uuid, neighbourhood_confidence varchar(20), area_id uuid, created_at timestamp with time zone, backup_created_at timestamp with time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public       | confidence_reviews                   | CREATE TABLE public.confidence_reviews (id uuid NOT NULL, business_id uuid, mapping_log_id uuid, review_action text NOT NULL, original_confidence text, reviewed_confidence text, review_notes text, old_category_id uuid, new_category_id uuid, old_subcategory_id uuid, new_subcategory_id uuid, reviewed_by uuid NOT NULL, reviewed_at timestamp with time zone);                                                                                                                                                                                                                                                                                                                                                                                                             |
| public       | friend_requests                      | CREATE TABLE public.friend_requests (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, from_user uuid NOT NULL, to_user uuid NOT NULL, status text NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public       | friendships                          | CREATE TABLE public.friendships (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, user_a uuid NOT NULL, user_b uuid NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public       | google_places_cache                  | CREATE TABLE public.google_places_cache (id uuid NOT NULL, place_id text NOT NULL, data jsonb NOT NULL, cached_at timestamp with time zone NOT NULL, created_at timestamp with time zone NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public       | list_items                           | CREATE TABLE public.list_items (id uuid NOT NULL, list_id uuid, name text NOT NULL, sort_order integer, parent_id uuid, code_name text, metadata jsonb, bounds_north numeric(10,6), bounds_south numeric(10,6), bounds_east numeric(10,6), bounds_west numeric(10,6), center_lat numeric(10,6), center_lng numeric(10,6));                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public       | lists                                | CREATE TABLE public.lists (id uuid NOT NULL, name text NOT NULL, description text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public       | mapping_decision_log                 | CREATE TABLE public.mapping_decision_log (id uuid NOT NULL, business_id uuid, backfill_progress_id uuid, google_types ARRAY NOT NULL, primary_google_type text, google_type_specificity_score integer, search_category_id uuid, assigned_category_id uuid, assigned_subcategory_id uuid, confidence_level text NOT NULL, confidence_score numeric(5,2), mapping_reason text NOT NULL, decision_factors jsonb, mapping_method text, created_subcategory boolean, mapped_at timestamp with time zone, mapped_by uuid);                                                                                                                                                                                                                                                             |
| public       | neighbourhoods                       | CREATE TABLE public.neighbourhoods (id uuid NOT NULL, code varchar(50) NOT NULL, name varchar(100) NOT NULL, borough_name varchar(100) NOT NULL, polygon jsonb NOT NULL, center_lat numeric(10,7) NOT NULL, center_lng numeric(10,7) NOT NULL, area_km2 numeric(8,3), type varchar(20), aliases ARRAY, characteristics jsonb, business_count integer, created_at timestamp with time zone, updated_at timestamp with time zone, list_item_id uuid);                                                                                                                                                                                                                                                                                                                              |
| public       | notifications                        | CREATE TABLE public.notifications (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, user_id uuid NOT NULL, type text NOT NULL, payload jsonb NOT NULL, is_read boolean NOT NULL);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public       | profiles                             | CREATE TABLE public.profiles (id uuid NOT NULL, username text, avatar_url text, created_at timestamp with time zone NOT NULL, default_city_id uuid, full_name text, bio text, updated_at timestamp with time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public       | quality_improvements                 | CREATE TABLE public.quality_improvements (id uuid NOT NULL, business_id uuid, improvement_type varchar(50) NOT NULL, field_name varchar(50), old_value text, new_value text, old_confidence varchar(20), new_confidence varchar(20), quality_score_before integer, quality_score_after integer, improved_by uuid, improvement_method varchar(50), improvement_date timestamp without time zone, notes text, session_id uuid, batch_id uuid, source_system varchar(50));                                                                                                                                                                                                                                                                                                          |
| public       | rec_requests                         | CREATE TABLE public.rec_requests (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, user_id uuid NOT NULL, title text NOT NULL, city_id uuid, category_id uuid, status text NOT NULL, area_id uuid, subcategory_id uuid, context text, best_response_id uuid, neighbourhood_id uuid);                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public       | rec_responses                        | CREATE TABLE public.rec_responses (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, request_id uuid NOT NULL, user_id uuid NOT NULL, business_id uuid NOT NULL, comment text, is_thanked boolean);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public       | request_templates                    | CREATE TABLE public.request_templates (id uuid NOT NULL, icon text NOT NULL, title text NOT NULL, category_name text, subcategory_name text, context text, usage_count integer, created_at timestamp without time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public       | spatial_ref_sys                      | CREATE TABLE public.spatial_ref_sys (srid integer NOT NULL, auth_name varchar(256), auth_srid integer, srtext varchar(2048), proj4text varchar(2048));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public       | users                                | CREATE TABLE public.users (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, email text, display_name text);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public       | vouches                              | CREATE TABLE public.vouches (id uuid NOT NULL, created_at timestamp with time zone NOT NULL, business_id uuid NOT NULL, user_id uuid, sentiment boolean, comment text, updated_at timestamp with time zone);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |